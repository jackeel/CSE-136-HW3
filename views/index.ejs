<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<title>Bookmarx</title>
	<link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
	<!-- <link rel="stylesheet" type="text/css" href="/css/simplegrid.css" /> -->
	<link rel="stylesheet" type="text/css" href="/css/style.css">
	<!-- <link rel="stylesheet" type="text/css" href="/css/edit.css">
	<link rel="stylesheet" type="text/css" href="/css/dropdown.css">
	<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300|Montserrat:400,700' rel='stylesheet' type='text/css'>-->

    <script type="text/javascript" src="/js/jquery.min.js"></script>
	<script type="text/javascript" src="/js/index.js"></script>
<<<<<<< HEAD
		<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	  ga('create', 'UA-78501484-1', 'auto');
	  ga('send', 'pageview');
		</script>

		<!-- Hotjar Tracking Code for http://ec2-54-191-195-138.us-west-2.compute.amazon -->
	<script>
	    (function(h,o,t,j,a,r){
	        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
	        h._hjSettings={hjid:221373,hjsv:5};
	        a=o.getElementsByTagName('head')[0];
	        r=o.createElement('script');r.async=1;
	        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
	        a.appendChild(r);
	    })(window,document,'//static.hotjar.com/c/hotjar-','.js?sv=');
	</script>
</head>
<body>
	<!-- admin route only for dev team --> 
	<!-- http://ec2-54-191-215-183.us-west-2.compute.amazonaws.com:4000/delete --> 
	<div id="load-gif"></div>
	<nav class="navbar">
		<ul>
			<li class="navbar-left menu-button full-width">
				<a href="#openSidebar" class="button" id="menu"><i id="menu-icon" class="fa fa-bookmark-o fa-lg"></i> Bookmarx</a>
			</li>
	  		<li class="navbar-left search full-width">
	  			<form method="get" name="search" id="searchForm">
	  				<% if(search == '') { %>
	  					<input class="min-input" name="Search" type="text" placeholder="Search Bookmarks" />
	  				<% } else { %>
	  					<input name="Search" type="text" value="<%= search%>"/>
	  				<% } %>

      				<input name="CurrentFolderId" type="hidden" value="<%= current_folder_id%>"/>
					<input name="CurrentOffset" type="hidden" value="<%= offset%>"/>
      				<input name="SortBy" type="hidden" value="<%= order_by%>"/>
	  				<button id ="searchButton"><i class="fa fa-search fa-lg"></i></button>
	  			</form>
	  		</li>
		  		<li class="navbar-right min-sort-size">
					<!-- need to add  this div class func so css works with it 	<div class="dropdown">
						<div class="dropdown-content"> -->
				<form method="get" name="orderBy" id="orderByForm">
				    <input name="Search" type="hidden" value="<%= search%>"/>
					<!--<select class="select-btn pull-right standardize-header-components" name="SortBy" onchange='this.form.submit()'>-->
					<select class="select-dropdown-content nav-btn" name="SortBy">
			        	<option disabled <%=order_by == undefined ? "" : "selected"%>>Sort</option>
			        	<option value="bookmarks.title" <%=order_by == "bookmarks.title" ? "selected" : ""%>>Title</option>
			        	<option value="bookmarks.url" <%=order_by == "bookmarks.url" ? "selected" : ""%>>URL</option>
			        	<option value="bookmarks.create_date" <%=order_by == "bookmarks.create_date" ? "selected" : ""%>>Create Date</option>
			        	<option value="bookmarks.last_visit_date" <%=order_by == "bookmarks.last_visit_date" ? "selected" : ""%>>Last Visits</option>
			        	<option value="bookmarks.star" <%=order_by == "bookmarks.star" ? "selected" : ""%>>Starred</option>
			        </select>
			        <noscript><input class = "nav-btn" type="submit" value="Sort!"></noscript>
			    </form>
				<!--		</div> </div>  -->
		  		</li>
	  			<li class="navbar-right">
	  				<a href="#addBookmark" class="button"><i class="fa fa-plus fa-lg"></i></a>
	  				<a href="#importBookmark" class="button">import&nbsp;&nbsp;&nbsp;<i class="fa fa-download fa-lg"></i></a>
					<a href="#changePassword" class="button"><i class="fa fa-cog fa-lg"></i></a>

	  				<div id="addBookmark" class="modalDialog">

				    <div class="grid grid-pad">
				    	<a href="#close" title="Close" class="close x-button">x</a>
				    	<div class="tabs is-centered">
						  <ul>
						    <li id="add-bookmark" class="is-active"><a>Add Bookmark</a></li>
						<!--    <li id="import-bookmark"><a>Import Bookmarks</a></li>-->
						  </ul>
						    </div>
							    <form method='post' action='/insert' id="addBookmarkForm">
							        <div class="form" id="add-bookmark-form">
									    <input type="text" name="title" value="" placeholder="Title" maxlength="25"  autofocus required>

									    <div class="textFieldWrapper">
									      <input type="url" name="url" value="" placeholder="http://www.example.com" maxlength="2083" required>
									    </div>

									    <input type="text" name="description" value="" placeholder="Description">

											<div class="ListFieldWrapper">
											<select class="select-dropdown-content" name="folder_id">
												<% folders.forEach(function(folder) { %>
													<option value="<%= folder.id%>" <%=current_folder_id == folder.id ? "selected" : ""%> ><%= folder.name %></option>
												<% }); %>
											</select>
											</div>

										    <div class="buttonWrapper">
										      	<div><input type='submit' value="Save"></div>
										      	<div><a href="#close" title="Close" class="close"><i class="fa fa-times-circle fa-lg"></i> Cancel</a></div>
											</div>
									</div>
								</form>
						</div>
						<div class="form" id="import-bookmark-form">
							<form method="post" action="/upload" enctype="multipart/form-data">
							<div class="textFieldWrapper">
						      <input type="file" name="bookmark-import">
						    </div>
						    <div class="buttonWrapper">
						    		<div><input type='submit' value="Upload"></div>
							      	<div><a href="#close" title="Close" class="close"><i class="fa fa-times-circle fa-lg"></i> Cancel</a></div>
							</div>
						    </form>
						</div>
					</div>

				<div id="changePassword" class="modalDialog">
                    <div class="grid grid-pad">
                        <a href="#close" title="Close" class="close x-button">x</a>
                        <div class="tabs is-centered">
                            <ul>
                                <li id="ac" class="is-active"><a>Change Password</a></li>
                            </ul>
                        </div>
                        <form id="resetPassword" method="post" action="/passwordReset" >
                            <div class="form" id="pw">
							    <input type="password" name="password" id="password" value="" placeholder="Password" spellcheck="false" maxlength="64" required>
							    <input type="password" name="confirm_password" id="confirm_password" value="" placeholder="Confirm Password" spellcheck="false" maxlength="64" required>
							</div>
                            <div class="buttonWrapper">
                                <input type='submit' value="Change Password">
                                <a href="#close" title="Close" class="close"><i class="fa fa-times-circle fa-lg"></i> Cancel</a>
                            </div>
                        </form>
                    </div>
			    </div>

				<div id="importBookmark" class="modalDialog">
                        <div class="grid grid-pad">
                            <a href="#close" title="Close" class="close x-button">x</a>
                            <div class="tabs is-centered">
                                <ul>
                                    <li id="add-bookmark1" class="is-active"><a>Import Bookmarks!</a></li>
                                </ul>
                            </div>
                            <form method="post" action="/upload" enctype="multipart/form-data">
                                <div class="form" id="add-bookmark-form2">
                                     <input type="file" accept = ".json" name="bookmark-import" >

                                    <div class="buttonWrapper">
                                        <div><input type='submit' value="Upload"></div>
                                        <div><a href="#close" title="Close" class="close"><i class="fa fa-times-circle fa-lg"></i> Cancel</a></div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>

                    <div id="addFolder" class="modalDialog">
                        <div class="grid grid-pad">
                            <a href="#close" title="Close" class="close x-button">x</a>
                            <div class="tabs is-centered">
                                <ul>
                                    <li id="add-bookmark2" class="is-active"><a>Add Folder</a></li>
                                </ul>
                            </div>
                            <form method='post' action='folders' id="addFolderForm">
                                <div class="form" id="add-bookmark-form1">
                                    <input type="text" id="addFolderName" name="name" placeholder="Name" maxlength="25" required>

                                    <div class="buttonWrapper">
                                        <div><input type='submit' value="Save"></div>
                                        <div><a href="#close" title="Close" class="close"><i class="fa fa-times-circle fa-lg"></i> Cancel</a></div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
	  		</li>
		</ul>
	</nav>
	<div id="openSidebar" class="showSidebar">
		<div id="sidebar">
			<input type="hidden" id="currentStar" value="<%=star%>"></input>
	      <ul id="folderList">
	      	    <li class="pinned"><a id="folder-starred" href="/list?Star=1" <%- (!current_folder_id && star == 1) ? "class='active-folder'" : "class='inactive-folder'" %>><i class="fa fa-star fa-lg"></i> Starred</a></li>
	            <li class="pinned"><a id="folder-" href="/list" <%- (!current_folder_id && star == 0) ? "class='active-folder'" : "class='inactive-folder'" %>><i class="fa fa-th fa-lg"></i> All</a></li>
                <div id="folder-placeholder" <%= (folders.length != 0) ? "style=display:none;" : "" %>>
                    <li>You have no folders.</li>
                    <li>Click add folder below to create a folder.</li>
                </div>
	            <% folders.forEach(function(folder) { %>
	            	<li><a id="folder-<%=folder.id%>" href="/list/<%= folder.id%>" <%- current_folder_id == folder.id ? "class='active-folder'" : "class='inactive-folder'" %>><%= folder.name%></a>
	                    <a class="pad-trash-icon" href="/folders/delete/<%= folder.id%>" id="delete-folder-<%=folder.id%>"><i class="fa fa-trash-o fa-lg"></i></a>
	                </li>
	            <% }); %>
	      </ul>
	      <div class="buttonWrapper">


	      	<a href="#addFolder" ><div><i class="fa fa-plus-circle fa-lg"></i> Folder</div></a>


	        <a href="/bookmarks/download" ><div><i class="fa fa-upload fa-lg"></i> Export</div></a>
	        <noscript>
	        	<a class="hideClose" href="#" ><div><i class="fa fa-times fa-lg"></i>Close</div></a>
	        </noscript>
	      	<a href="/logout" ><div><i class="fa fa-sign-out fa-lg"></i> Logout</div></a>
		  </div>
	    </div>
    </div>
    <div id="right">
      <div id="right-content" class="main grid grid-pad">
      		<div id="title" class="col-1-1">
      			<div class="content">
      				<h1>BookMarx</h1>
      			</div>
      		</div>
      		<div id="bookmarks">
			<% bookmarks.forEach(function(bookmark) { %>
	      	<div class="col-1-3 mobile-col-1-3 card-min-width">
				<div class="content">
					<div class="card card--small" id="bookmark-card-<%=bookmark.id%>">
						<div style="background-color:#DE2924" class="card__image"></div>
						<a class="bookmark-link" id="bookmark-url-<%=bookmark.id%>" href="<%= bookmark.url %>"><h2 id="title-bookmark-<%= bookmark.id %>" class="card__title"><%= bookmark.title %></h2></a>
							<div class="card__action-bar">
							<% if (bookmark.star == 0) { %>
  								<a class="card__button" href="/bookmarks/<%= bookmark.id%>/star" id="star-bookmark-<%=bookmark.id%>"><i class="fa fa-star fa-lg fa-star-inactive"></i></a>
							<% } else { %>
								<a class="card__button" href="/bookmarks/<%= bookmark.id%>/unstar" id="star-bookmark-<%=bookmark.id%>"><i class="fa fa-star fa-lg"></i></a>
							<% } %>
							<a class="card__button" href="/bookmarks/edit/<%= bookmark.id%>" id="edit-bookmark-<%=bookmark.id%>"><i class="fa fa-info-circle fa-lg"></i></a>
						    <a class="card__button" href="/bookmarks/delete/<%= bookmark.id%>" id="delete-bookmark-<%=bookmark.id%>"><i class="fa fa-trash-o fa-lg"></i></a>
						</div>
					</div>
				</div>
			</div>
			<% }); %>
		</div>

		<div id="pagination">
			<% for(i=1; i <= num_pagination ; i++) { %>
			    <a <%=(offset == i) ? "class=active": ""%> href=<%="/list/"+(current_folder_id == undefined ? "": current_folder_id) +
                "?Search="+search+"&SortBy="+order_by+"&offset="+i + (star == 1 ? "&Star=1" : "")%>><%=i%></a>
			<% }%>
	  	</div>

			<div id="editBookmark" class="modalDialog">

			<div class="grid grid-pad">
				<a href="#close" title="Close" class="close x-button">x</a>
				<div class="tabs is-centered">
				<ul>
					<li id="edit-bookmark" class="is-active"><a>Edit Bookmark</a></li>
				</ul>
			</div>
			<form action="/bookmarks/update/" id="editBookmarkForm" method="post">
					<table class="edit-table">
							<tr><td>Title: </td><td><input class="edit-modal-input" type="text" name="title"  value="" maxlength="25" autofocus required></td></tr>
							<tr><td>URL: </td><td><input class="edit-modal-input" type="url" name="url" value="" placeholder="http://www.example.com" maxlength="2083" required></td></tr>
							<tr><td>Description:</td><td><input class="edit-modal-input" type="text" name="description" value=""></td></td></tr>
							<tr><td>Folder: </td><td>
									<select class="edit-select-content" name="folder_id">
											<% folders.forEach(function(folder) { %>
													<option value="<%= folder.id%>" <%=bookmarks.folder_id == folder.id ? "selected" : ""%>><%= folder.name %></option>
											<% }); %>
									</select>
							</td>
							</tr>
							<tr>
									<td colspan="2">
											<input class="edit-button" type='submit' value="Save">
											&nbsp;

											<!-- Could also pass to the server as a submit and determine redirect action there -->
											<a href='#close' style="text-decoration: none;"><input class="edit-button" type="button" value='Cancel'></a>
									</td>
							</tr>
					</table>
			</form>
				 </div>
		</div>

		<div id="confirmDelete" class="modalDialog">
		<div class="grid grid-pad">
			<a href="#close" title="Close" class="close x-button">x</a>
			<div class="tabs is-centered">
			    <ul class="remove-default-padding">
				    <li id="confirmdelete-bookmark" class="is-active"><a>Confirm Delete</a></li>
			    </ul>
			</div>
			<p class="pink-error-text">
            	Are you sure you wish to delete?
            </p>
            <br>
			<form class ="pink-error-text" id="confirmDeleteForm">
					<input id="confirmDeleteTitle" name="title" type="submit" value="Confirm Delete">
					<br>
					<a href='#close' style="text-decoration: none;"><input class="confirmdelete-button" type="button" value="Cancel" ></a>
			</form>
		</div>

			 </div>
		 </div>


			<div id="warningModal" class="modalDialog">
                <div class="grid grid-pad">
                    <a href="#close" title="Close" class="close x-button">x</a>
                    <div class="tabs is-centered">
                        <ul class="remove-default-padding">
                            <li id="warningTitle" class="is-active"><a>Error</a></li>
                        </ul>
                    </div>
                    <p id="warningMessage" class="pink-error-text">
                        <% if(typeof errors !== 'undefined') { %>
				            <%= errors %>
				        <% } else { %>
				            An error has occurred.
				        <% } %>
                    </p>
                </div>
            </div>


      </div>
    </div>

</body>
</html>
